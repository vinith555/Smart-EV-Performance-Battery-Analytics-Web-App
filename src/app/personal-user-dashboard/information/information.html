<div class="flex flex-col gap-y-8 mx-6">

    <section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 p-4">

        <div class="rounded-2xl bg-white p-6 shadow-md hover:shadow-lg transition">
        
        <div class="flex items-center justify-between">
            <h3 class="text-sm font-semibold text-slate-600">Battery Health</h3>
            <i class="fa-solid fa-heart-pulse text-blue-500 text-2xl"></i>
        </div>
        <p class="mt-4 text-3xl font-bold text-slate-800">85%</p>
        <p class="mt-1 text-sm text-slate-500">Good condition</p>
        <div class="mt-4 h-2 w-full rounded-full bg-slate-200">
            <div class="h-full w-[85%] rounded-full bg-blue-500"></div>
        </div>
        </div>

        <div class="rounded-2xl bg-white p-6 shadow-md hover:shadow-lg transition">
            <div class="flex items-center justify-between">
            <h3 class="text-sm font-semibold text-slate-600">Current Charge</h3>
            <i class="fa-solid fa-bolt text-green-500 text-2xl"></i>
            </div>

            <p class="mt-4 text-3xl font-bold text-slate-800">64%</p>
            <p class="mt-1 text-sm text-slate-500">Charging normally</p>

            <div class="mt-4 h-2 w-full rounded-full bg-slate-200">
            <div class="h-full w-[64%] rounded-full bg-green-500"></div>
            </div>
        </div>

        <div class="rounded-2xl bg-white p-6 shadow-md hover:shadow-lg transition">
            <div class="flex items-center justify-between">
            <h3 class="text-sm font-semibold text-slate-600">Charge Cycles</h3>
            <i class="fa-solid fa-rotate text-purple-500 text-2xl"></i>
            </div>

            <p class="mt-4 text-3xl font-bold text-slate-800">487</p>
            <p class="mt-1 text-sm text-slate-500">Normal usage</p>

            <p class="mt-4 text-xs text-slate-400">
            Typical lifespan ~1000 cycles
            </p>
        </div>

        <div class="rounded-2xl bg-white p-6 shadow-md hover:shadow-lg transition">
            <div class="flex items-center justify-between">
            <h3 class="text-sm font-semibold text-slate-600">Temperature</h3>
            <i class="fa-solid fa-temperature-three-quarters text-orange-500 text-2xl"></i>
            </div>

            <p class="mt-4 text-3xl font-bold text-slate-800">32Â°C</p>
            <p class="mt-1 text-sm text-slate-500">Optimal range</p>

            <div class="mt-4 h-2 w-full rounded-full bg-slate-200">
            <div class="h-full w-[45%] rounded-full bg-orange-500"></div>
            </div>
        </div>

    </section>

    <section class="w-full rounded-lg h-auto bg-white p-4 shadow-md">
        <h2 class="text-xl font-semibold">All Invoices</h2>
        <div class="overflow-x-auto mt-4">
            <table class="min-w-full">
                <thead class="text-gray-500 text-sm uppercase">
                <tr class="border-b">
                    <th class="px-4 py-3 text-left">Invoice #</th>
                    <th class="px-4 py-3 text-left">Vehicle No</th>
                    <th class="px-4 py-3 text-left">Customer</th>
                    <th class="px-4 py-3 text-left">Service</th>
                    <th class="px-4 py-3 text-left">Date</th>
                    <th class="px-4 py-3 text-left">Amount</th>
                    <th class="px-4 py-3 text-left">Status</th>
                    <th class="px-4 py-3 text-center">Actions</th>
                </tr>
                </thead>

                <tbody class="divide-y">
                <tr
                    *ngFor="let invoice of paginatedinvoices"
                    class="hover:bg-gray-50 border-b border-gray-300"
                    >
                    <td class="px-4 py-3 text-blue-500">{{ invoice.invoiceNo }}</td>
                    <td class="px-4 py-3">{{ invoice.vehicleNo }}</td>
                    <td class="px-4 py-3">{{ invoice.customer }}</td>
                    <td class="px-4 py-3">{{ invoice.service }}</td>
                    <td class="px-4 py-3">{{ invoice.date }}</td>
                    <td class="px-4 py-3 font-semibold">{{ invoice.amount }}</td>

                    <td class="px-4 py-3">
                        <span
                        class="px-2 py-1 text-md border rounded"
                        [ngClass]="{
                            'border-green-500 bg-green-100 text-green-700': invoice.status === 'Paid',
                            'border-yellow-500 bg-yellow-100 text-yellow-700': invoice.status === 'Pending'
                        }"
                        >
                        {{ invoice.status }}
                        </span>
                    </td>

                    <td class="px-4 py-3 text-center space-x-2">
                        <button class="text-blue-600 cursor-pointer">
                        <i class="fa-solid fa-eye"></i>
                        </button>
                        <button class="text-green-600 cursor-pointer">
                        <i class="fa-solid fa-download"></i>
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
            
        </div>
        <div class="flex justify-between my-4">
                <button class="text-blue-600 hover:text-blue-700 cursor-pointer disabled:text-gray-400" (click)="previous()" [disabled]="index1 <= 0"><i class="fa-solid fa-caret-left "></i>Prev</button>
                <button class="text-blue-600 hover:text-blue-700 cursor-pointer disabled:text-gray-400" (click)="next()" [disabled]="index1 >= invoices.length - pageSize">Next<i class="fa-solid fa-caret-right"></i></button>
        </div>
    </section>

    <section class="w-full rounded-lg bg-white p-4 shadow-md">
      <h2 class="text-xl font-semibold">Vehicle Issues & Faults</h2>

      <div class="overflow-x-auto mt-4">
        <table class="min-w-full">
          <thead class="text-gray-500 text-sm uppercase">
            <tr class="border-b">
              <th class="px-4 py-3 text-left">Issue ID</th>
              <th class="px-4 py-3 text-left">Vehicle No</th>
              <th class="px-4 py-3 text-left">Category</th>
              <th class="px-4 py-3 text-left">Description</th>
              <th class="px-4 py-3 text-left">Detected On</th>
              <th class="px-4 py-3 text-left">Priority</th>
              <th class="px-4 py-3 text-left">Status</th>
              <th class="px-4 py-3 text-center">Actions</th>
            </tr>
          </thead>

          <tbody class="divide-y">
            <tr
              *ngFor="let issue of paginatedIssues; let i = index"
              class="hover:bg-gray-50 border-b border-gray-200"
            >
              <td class="px-4 py-3 text-blue-600 font-medium">
                {{ issue.issueId }}
              </td>

              <td class="px-4 py-3">{{ issue.vehicleNo }}</td>
              <td class="px-4 py-3 font-mono">{{ issue.Category }}</td>

              <td class="px-4 py-3 max-w-xs truncate" title="{{ issue.description }}">
                {{ issue.description }}
              </td>

              <td class="px-4 py-3">{{ issue.dateReported }}</td>

              <td class="px-4 py-3">
                <span
                  class="px-2 py-1 text-sm border rounded"
                  [ngClass]="{
                    'border-red-500 bg-red-100 text-red-700': issue.priority === 'High',
                    'border-yellow-500 bg-yellow-100 text-yellow-700': issue.priority === 'Medium',
                    'border-green-500 bg-green-100 text-green-700': issue.priority === 'Low'
                  }"
                >
                  {{ issue.priority }}
                </span>
              </td>

              <td class="px-4 py-3">
                <span
                  class="px-2 py-1 text-sm border rounded"
                  [ngClass]="{
                    'border-green-500 bg-green-100 text-green-700': issue.status === 'Resolved',
                    'border-yellow-500 bg-yellow-100 text-yellow-700': issue.status === 'In Progress',
                    'border-red-500 bg-red-100 text-red-700': issue.status === 'Open'
                  }"
                >
                  {{ issue.status }}
                </span>
              </td>

              <td class="px-4 py-3 text-center space-x-2">
                <button class="text-blue-600 hover:text-blue-700" title="View" (click)="issueViewIndex = i; issueViewBox = true;">
                  <i class="fa-solid fa-eye"></i>
                </button>
                <button class="text-orange-600 hover:text-orange-700" title="Action" (click)="issueActionindex = i; issueactionForm = true;">
                  <i class="fa-solid fa-screwdriver-wrench"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <div class="flex justify-between my-4">
        <button
          class="text-blue-600 hover:text-blue-700 disabled:text-gray-400"
          (click)="previous2()"
          [disabled]="index2 <= 0"
        >
          <i class="fa-solid fa-caret-left"></i> Prev
        </button>

        <button
          class="text-blue-600 hover:text-blue-700 disabled:text-gray-400"
          (click)="next2()"
          [disabled]="index2 >= issues.length - pageSize"
        >
          Next <i class="fa-solid fa-caret-right"></i>
        </button>
      </div>
    </section>
</div>
<div *ngIf="issueViewBox" class="min-h-screen w-full fixed inset-0 flex items-center justify-center bg-black/40 z-30">
    <div class="overflow-x-auto flex flex-col gap-y-1 bg-white shadow shadow-gray-300 border-2 border-gray-200 rounded-md p-4">
        <div class="flex justify-start">
            <button (click)="issueViewBox = !issueViewBox" class="border-2 border-gray-300 hover:border-gray-700 rounded"><i class="text-gray-500 fa-solid fa-xmark"></i></button>
        </div>
        <div class="min-w-[350px] w-auto">
        <div class="flex justify-between">
            <p>Issue ID:</p><p class="ml-4 font-semibold">{{issues[issueViewIndex].issueId}}</p>
        </div>
        <div class="flex justify-between">
            <p>Vehicle NO:</p><p class="ml-4 font-semibold">{{issues[issueViewIndex].vehicleNo}}</p>
        </div>
        <div class="flex justify-between">
            <p>Category:</p><p class="ml-4 font-semibold">{{issues[issueViewIndex].Category}}</p>
        </div>
        <div class="flex justify-between">
            <p>Description:</p><p class="ml-4 font-semibold">{{issues[issueViewIndex].description}}</p>
        </div>
        <div class="flex justify-between">
            <p>Date Reported:</p><p class="ml-4 font-semibold">{{issues[issueViewIndex].dateReported}}</p>
        </div>
        <div class="flex justify-between">
            <p>Date Completed:</p><p class="ml-4 font-semibold">{{issues[issueViewIndex].dateCompleted}}</p>
        </div>
        <div class="flex justify-between">
            <p>Assigned To:</p><p class="ml-4 font-semibold">{{issues[issueViewIndex].assignedTo}}</p>
        </div>
        <div class="flex justify-between">
            <p>Assigned By:</p><p class="ml-4 font-semibold">{{issues[issueViewIndex].assignedBy}}</p>
        </div>
        <div class="flex justify-between">
            <p>Priority:</p><p class="ml-4 font-semibold">{{issues[issueViewIndex].priority}}</p>
        </div>
        <div class="flex justify-between">
            <p>Status:</p><p class="ml-4 font-semibold">{{issues[issueViewIndex].status}}</p>
        </div>
        <div class="flex justify-between">
            <p>Cost Of Issue:</p><p class="ml-4 font-semibold">{{issues[issueViewIndex].costofIssue}}</p>
        </div>
        <div>
            <p>Notes:</p>
            <textarea name="" id="" class="w-full border-2 border-gray-500 rounded p-2">{{issues[issueViewIndex].notes}}</textarea>
        </div>
        </div>
    </div>
</div>
<div *ngIf="issueactionForm" class="min-h-screen w-full fixed inset-0 flex items-center justify-center bg-black/40 z-30">
    <form
    #form="ngForm"
    (ngSubmit)="issueUpdatedData(form)"
    class="bg-white
           shadow shadow-gray-300 border-2 border-gray-200
           rounded-md p-4"
    >
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 p-5 w-full max-w-md sm:max-w-xl h-96 overflow-y-auto">
    <div>
      <p class="font-semibold">Issue ID</p>
      <input
        type="text"
        name="issueId"
        [(ngModel)] = "issues[issueActionindex].issueId"
        class="w-full border-2 border-gray-300 rounded bg-white p-1"
      />
    </div>

    <div>
      <p class="font-semibold">Vehicle NO</p>
      <input
        type="text"
        name="vehicleNo"
        [(ngModel)] = "issues[issueActionindex].vehicleNo"
        class="w-full border-2 border-gray-300 rounded bg-white p-1"
      />
    </div>

    <div>
      <p class="font-semibold">Category</p>
      <input
        type="text"
        name="Category"
        [(ngModel)] = "issues[issueActionindex].Category"
        class="w-full border-2 border-gray-300 rounded bg-white p-1"
      />
    </div>

    <div>
      <p class="font-semibold">Description</p>
      <input
        type="text"
        name="description"
        [(ngModel)] = "issues[issueActionindex].description"
        class="w-full border-2 border-gray-300 rounded bg-white p-1"
      />
    </div>

    <div>
      <p class="font-semibold">Date Reported</p>
      <input
        type="date"
        name="startDate"
        [(ngModel)] = "issues[issueActionindex].dateReported"
        class="w-full border-2 border-gray-300 rounded bg-white p-1"
      />
    </div>

    <div>
      <p class="font-semibold">Date Completed</p>
      <input
        type="date"
        name="endDate"
        [(ngModel)] = "issues[issueActionindex].dateCompleted"
        class="w-full border-2 border-gray-300 rounded bg-white p-1"
      />
    </div>

    <div>
      <p class="font-semibold">Assigned To</p>
      <input
        type="text"
        name="assignedTo"
        [(ngModel)] = "issues[issueActionindex].assignedTo"
        class="w-full border-2 border-gray-300 rounded bg-white p-1"
      />
    </div>

    <div>
      <p class="font-semibold">Assigned By</p>
      <input
        type="text"
        name="assignedBy"
        [(ngModel)] = "issues[issueActionindex].assignedBy"
        class="w-full border-2 border-gray-300 rounded bg-white p-1"
      />
    </div>

    <div>
      <p class="font-semibold">Priority</p>
      <select
        name="priority"
        [(ngModel)] = "issues[issueActionindex].priority"
        class="w-full border-2 border-gray-300 rounded bg-white p-1"
      >
        <option value="">Select</option>
        <option value="Low">Low</option>
        <option value="Medium">Medium</option>
        <option value="High">High</option>
      </select>
    </div>

    <div>
      <p class="font-semibold">Status</p>
      <select
        name="status"
        [(ngModel)] = "issues[issueActionindex].status"
        class="w-full border-2 border-gray-300 rounded bg-white p-1"
      >
        <option value="">Select</option>
        <option value="Open">Open</option>
        <option value="In Progress">In Progress</option>
        <option value="Resolved">Resolved</option>
      </select>
    </div>

    <div>
      <p class="font-semibold">Cost Of Issue</p>
      <input
        type="number"
        name="costofIssue"
        [(ngModel)] = "issues[issueActionindex].costofIssue"
        class="w-full border-2 border-gray-300 rounded bg-white p-1"
      />
    </div>

    <div>
      <p class="font-semibold">Attachment</p>
      <input
        type="file"
        name="attachment"
        [(ngModel)] = "issues[issueActionindex].attachment"
        class="w-full border-2 border-gray-300 rounded bg-white p-1"
      />
    </div>

    <div class="sm:col-span-2">
      <p class="font-semibold">Notes</p>
      <textarea
        name="notes"
        [(ngModel)] = "issues[issueActionindex].notes"
        class="w-full h-24 border-2 border-gray-300 rounded bg-white p-1"
      >
      </textarea>
    </div>
    </div>
    <div class="sm:col-span-2 flex justify-between mt-2">
      <button type="button" (click)="issueactionForm = !issueactionForm"
      class="px-3 py-1.5 rounded-full text-red-600 border-2 border-red-300 hover:text-white
               hover:bg-red-700 transition"
        >
        <i class="fa-solid fa-xmark"></i> Cancel
      </button>
      <button
        type="submit"
        class="px-3 py-1.5 rounded-full text-blue-600 border-2 border-blue-300 hover:text-white
               hover:bg-blue-700 transition"
      >
       <i class="fa-solid fa-pen-to-square"></i> Update
      </button>
    </div>
  </form>
</div>